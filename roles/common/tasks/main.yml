---
# Main tasks file for common role
# This file orchestrates all common configuration tasks

- name: Include OS-specific variables
  ansible.builtin.include_vars: "{{ ansible_os_family }}.yml"
  ignore_errors: true
  tags:
    - always

- name: Display common role execution
  ansible.builtin.debug:
    msg: "Applying common configuration to {{ inventory_hostname }}"
  tags:
    - always

- name: Update system and install packages
  ansible.builtin.import_tasks: packages.yml
  tags:
    - packages
    - common

- name: Configure system settings
  ansible.builtin.import_tasks: system.yml
  tags:
    - system
    - common

- name: Apply security hardening
  ansible.builtin.import_tasks: security.yml
  tags:
    - security
    - common

- name: Configure firewall
  ansible.builtin.import_tasks: firewall.yml
  tags:
    - firewall
    - common

- name: Common role execution completed
  ansible.builtin.debug:
    msg: "Common configuration applied successfully on {{ inventory_hostname }}"
  tags:
    - always